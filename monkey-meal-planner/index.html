<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Monkey Meal Planner</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: #fef6e4;
            color: #333;
            min-height: 100vh;
        }

        header {
            background: linear-gradient(135deg, #6b4226, #8b5e3c);
            color: #fff;
            padding: 1.5rem 2rem;
            text-align: center;
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
        }

        header h1 {
            font-size: 2.2rem;
            letter-spacing: 1px;
        }

        header h1 span.monkey-icon {
            font-size: 2.4rem;
        }

        header p {
            margin-top: 0.4rem;
            font-size: 1rem;
            opacity: 0.9;
        }

        .controls {
            display: flex;
            justify-content: center;
            gap: 1rem;
            padding: 1.5rem 1rem;
            flex-wrap: wrap;
        }

        .btn {
            padding: 0.75rem 1.8rem;
            font-size: 1rem;
            font-weight: 600;
            border: none;
            border-radius: 50px;
            cursor: pointer;
            transition: all 0.2s ease;
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
        }

        .btn-primary {
            background: linear-gradient(135deg, #e07b39, #d4621a);
            color: #fff;
            box-shadow: 0 4px 10px rgba(224, 123, 57, 0.35);
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 16px rgba(224, 123, 57, 0.5);
        }

        .btn-secondary {
            background: #fff;
            color: #6b4226;
            border: 2px solid #6b4226;
        }

        .btn-secondary:hover {
            background: #6b4226;
            color: #fff;
        }

        .btn-lock {
            background: #fff;
            color: #888;
            border: 2px solid #ccc;
            padding: 0.4rem 0.8rem;
            font-size: 0.85rem;
            border-radius: 20px;
        }

        .btn-lock.locked {
            background: #e07b39;
            color: #fff;
            border-color: #e07b39;
        }

        .calendar {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 1.2rem;
            padding: 0 2rem 2rem;
            max-width: 1400px;
            margin: 0 auto;
        }

        .day-card {
            background: #fff;
            border-radius: 16px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.08);
            overflow: hidden;
            transition: transform 0.2s ease, box-shadow 0.2s ease;
        }

        .day-card:hover {
            transform: translateY(-4px);
            box-shadow: 0 8px 24px rgba(0,0,0,0.12);
        }

        .day-card.shuffling .meal-name,
        .day-card.shuffling .meal-img {
            animation: shuffle 0.4s ease;
        }

        @keyframes shuffle {
            0% { opacity: 0; transform: translateY(-10px); }
            100% { opacity: 1; transform: translateY(0); }
        }

        .day-header {
            padding: 1rem 1.2rem;
            font-size: 1.1rem;
            font-weight: 700;
            color: #fff;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .day-card:nth-child(1) .day-header { background: #e07b39; }
        .day-card:nth-child(2) .day-header { background: #d4621a; }
        .day-card:nth-child(3) .day-header { background: #c0392b; }
        .day-card:nth-child(4) .day-header { background: #8e44ad; }
        .day-card:nth-child(5) .day-header { background: #2980b9; }
        .day-card:nth-child(6) .day-header { background: #27ae60; }
        .day-card:nth-child(7) .day-header { background: #f39c12; }

        .meal-img {
            width: 100%;
            height: 180px;
            object-fit: cover;
            display: block;
            background: #f5f0ea;
        }

        .day-body {
            padding: 1.2rem 1.2rem;
            min-height: 80px;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            text-align: center;
            gap: 0.8rem;
        }

        .meal-name {
            font-size: 1.15rem;
            font-weight: 600;
            color: #4a3520;
            line-height: 1.4;
        }

        .meal-link {
            font-size: 0.85rem;
            color: #2980b9;
            text-decoration: none;
        }

        .meal-link:hover {
            text-decoration: underline;
        }

        .day-actions {
            display: flex;
            gap: 0.5rem;
            flex-wrap: wrap;
            justify-content: center;
        }

        .btn-swap {
            background: #f0f0f0;
            color: #555;
            border: none;
            padding: 0.4rem 0.8rem;
            font-size: 0.85rem;
            border-radius: 20px;
            cursor: pointer;
            transition: all 0.15s ease;
        }

        .btn-swap:hover {
            background: #e07b39;
            color: #fff;
        }

        footer {
            text-align: center;
            padding: 2rem 1rem;
            color: #999;
            font-size: 0.85rem;
        }

        footer a {
            color: #e07b39;
            text-decoration: none;
        }

        footer a:hover {
            text-decoration: underline;
        }

        .meal-count {
            background: rgba(255,255,255,0.25);
            padding: 0.2rem 0.6rem;
            border-radius: 12px;
            font-size: 0.75rem;
            font-weight: 400;
        }

        @media (max-width: 600px) {
            header h1 { font-size: 1.6rem; }
            .calendar { padding: 0 1rem 1.5rem; gap: 1rem; }
            .controls { padding: 1rem; }
            .btn { padding: 0.6rem 1.2rem; font-size: 0.9rem; }
        }
    </style>
</head>
<body>
    <header>
        <h1><span class="monkey-icon">&#x1F435;</span> Monkey Meal Planner</h1>
        <p>Your weekly dinner plan â€” 94 NHS Healthier Families recipes</p>
    </header>

    <div class="controls">
        <button class="btn btn-primary" id="shuffleAllBtn" onclick="shuffleAll()">&#x1F500; Shuffle All</button>
        <button class="btn btn-secondary" id="printBtn" onclick="window.print()">&#x1F5A8; Print Plan</button>
    </div>

    <div class="calendar" id="calendar"></div>

    <footer>
        Recipes from <a href="https://www.nhs.uk/healthier-families/recipes/dinner" target="_blank" rel="noopener">NHS Healthier Families</a>.
        All 94 dinner recipes available.
    </footer>

    <script>
        const mealData = {
            "Asaro potato porridge": "https://assets.nhs.uk/campaigns-cms-prod/original_images/Asaro_Mpotopoto.jpg",
            "Bajan cou cou with spicy fish": "https://assets.nhs.uk/campaigns-cms-prod/original_images/Bajan-cou-cou-with-spicy-fish.jpg",
            "Baked potatoes with mince": "https://assets.nhs.uk/campaigns-cms-prod/original_images/Baked_potatoes_with_mince.png",
            "Bang-tasty chicken drumsticks": "https://assets.nhs.uk/campaigns-cms-prod/original_images/Bang_Tasty_Chicken_Drummers.png",
            "Bariis iskukaris": "https://assets.nhs.uk/campaigns-cms-prod/original_images/Bariis_iskukaris.png",
            "Bengali-style chicken curry": "https://assets.nhs.uk/campaigns-cms-prod/original_images/Bengali_Chicken_Curry.jpg",
            "Bharelu shaak": "https://assets.nhs.uk/campaigns-cms-prod/original_images/Bharelu_shaak_-_Gujurati_stuffed_veg.jpg",
            "Brilliant beef curry": "https://assets.nhs.uk/campaigns-cms-prod/original_images/Recipes-card-beef-curry.jpg",
            "Caribbean tofu and sweet potato curry with rice and peas": "https://assets.nhs.uk/campaigns-cms-prod/original_images/Caribbean_tofu_and_sweet_potato_curry.png",
            "Cheats' pizza calzone": "https://assets.nhs.uk/campaigns-cms-prod/original_images/Cheats_pizza_calzone.png",
            "Cheese and tomato grilled fish": "https://assets.nhs.uk/campaigns-cms-prod/original_images/Cheese-and-tomato-grilled-fish.jpg",
            "Cheesy ham and leek bake": "https://assets.nhs.uk/campaigns-cms-prod/original_images/Cheesy_leeks_and_ham_bake.png",
            "Cheesy veggie wedges": "https://assets.nhs.uk/campaigns-cms-prod/original_images/Cheesy_veggie_wedges_d1jbq06.png",
            "Chicken and banana korma": "https://assets.nhs.uk/campaigns-cms-prod/original_images/Chicken_and_Banana_Korma.png",
            "Chicken and tomato jacket potato recipe": "https://assets.nhs.uk/campaigns-cms-prod/original_images/Chicken__tomato_jacket_potato_RShpxAc.png",
            "Chicken and vegetable parcels": "https://assets.nhs.uk/campaigns-cms-prod/original_images/Chicken_and_vegetable_parcels.png",
            "Chicken jalfrezi": "https://assets.nhs.uk/campaigns-cms-prod/original_images/Chicken_jalfrezi.jpg",
            "Chicken pasta with peas": "https://assets.nhs.uk/campaigns-cms-prod/original_images/Chicken_pasta_with_peas.png",
            "Chilli beef and bean burgers": "https://assets.nhs.uk/campaigns-cms-prod/original_images/Chilli-beef-and-bean-burgers.jpg",
            "Chilli con carne": "https://assets.nhs.uk/campaigns-cms-prod/original_images/Chilli-con-carne.jpg",
            "Classic cottage pie": "https://assets.nhs.uk/campaigns-cms-prod/original_images/Classic_cottage_pie.png",
            "Corn frizzlers": "https://assets.nhs.uk/campaigns-cms-prod/original_images/Corn_frizzlers.png",
            "Crunchy fish fingers with wedges": "https://assets.nhs.uk/campaigns-cms-prod/original_images/Crunchy_fish_fingers_with_wedges.png",
            "Deresh curry": "https://assets.nhs.uk/campaigns-cms-prod/original_images/Deresh-curry.jpg",
            "Ewa oloyin with plantain": "https://assets.nhs.uk/campaigns-cms-prod/original_images/Ewa-oloyin-with-plantain.jpg",
            "Eyeball meatballs": "https://assets.nhs.uk/campaigns-cms-prod/original_images/Recipes_-_Card_-_Eyeball_meatballs.png",
            "Fabulous fish pie": "https://assets.nhs.uk/campaigns-cms-prod/original_images/Fabulous_fish_pie_D4BYRTl.png",
            "Four seasons pizza": "https://assets.nhs.uk/campaigns-cms-prod/original_images/Four_seasons_pizza.png",
            "Good old fish and chips": "https://assets.nhs.uk/campaigns-cms-prod/original_images/Fish_and_chips.png",
            "Herby pasta with veg": "https://assets.nhs.uk/campaigns-cms-prod/original_images/Pasta_with_veg_in_a_herb_sauce.png",
            "Jerk-style chicken skewers": "https://assets.nhs.uk/campaigns-cms-prod/original_images/Jerk-style-chicken-skewers.jpg",
            "Jollof rice": "https://assets.nhs.uk/campaigns-cms-prod/original_images/Jollof_rice.png",
            "Kedgeree with a kick": "https://assets.nhs.uk/campaigns-cms-prod/original_images/Kedgeree_with_a_kick.png",
            "Lime fish skewers": "https://assets.nhs.uk/campaigns-cms-prod/original_images/Lime_fish_skewers.png",
            "Mac and veg slices": "https://assets.nhs.uk/campaigns-cms-prod/original_images/Mac_and_veg_slices.png",
            "Macaroni cheese with tomatoes": "https://assets.nhs.uk/campaigns-cms-prod/original_images/Recipes-card-macaroni-tomatoes.jpg",
            "Macher jhol": "https://assets.nhs.uk/campaigns-cms-prod/original_images/Macher-jhol.jpg",
            "Mean and green mac and cheese recipe": "https://assets.nhs.uk/campaigns-cms-prod/original_images/Vegetable_mac_and_cheese.png",
            "Meat-free cottage pie": "https://assets.nhs.uk/campaigns-cms-prod/original_images/Meat_free_cottage_pie.png",
            "Meatballs and sauce": "https://assets.nhs.uk/campaigns-cms-prod/original_images/Meatballs_and_sauce.png",
            "Mediterranean potato bake": "https://assets.nhs.uk/campaigns-cms-prod/original_images/Mediterranean_potato_bake.png",
            "Mexican bean and tomato soup": "https://assets.nhs.uk/campaigns-cms-prod/original_images/Mexican_bean_and_tomato_soup.png",
            "Mushroom risotto": "https://assets.nhs.uk/campaigns-cms-prod/original_images/Mushroom_risotto.png",
            "Oat fufu with kale riro": "https://assets.nhs.uk/campaigns-cms-prod/original_images/Oat_fufu_and_Kale_riro.png",
            "Old school sausage and mash": "https://assets.nhs.uk/campaigns-cms-prod/original_images/Old-school-sausage-n-mash.jpg",
            "Pakistani saag aloo": "https://assets.nhs.uk/campaigns-cms-prod/original_images/Pakistani-saag-aloo.jpg",
            "Panjabi dhal": "https://assets.nhs.uk/campaigns-cms-prod/original_images/Panjabi_dhal.png",
            "Panjabi keema": "https://assets.nhs.uk/campaigns-cms-prod/original_images/Panjabi_Keema.png",
            "Pasta carbonara": "https://assets.nhs.uk/campaigns-cms-prod/original_images/Pasta_carbonara.png",
            "Pasta ratatouille bake": "https://assets.nhs.uk/campaigns-cms-prod/original_images/Pasta_ratatouille_bake.png",
            "Pea poppin' risotto": "https://assets.nhs.uk/campaigns-cms-prod/original_images/Pea-poppin-risotto.jpg",
            "Peppers with spicy turkey stuffing": "https://assets.nhs.uk/campaigns-cms-prod/original_images/Peppers_with_spicy_turkey_stuffing.png",
            "Perfect pasta and tomato sauce": "https://assets.nhs.uk/campaigns-cms-prod/original_images/Perfect-pasta-and-tomato-sauce.jpg",
            "Pesto and parmesan salmon": "https://assets.nhs.uk/campaigns-cms-prod/original_images/Pesto__parmesan_salmon.png",
            "Pesto tagliatelle, peppers and squash": "https://assets.nhs.uk/campaigns-cms-prod/original_images/Pesto_tagliatelle_peppers__squash.png",
            "Pigeon peas pilau with carrot pickle": "https://assets.nhs.uk/campaigns-cms-prod/original_images/Pigeon_Pea_Pilau_Carrot_Pickle.jpg",
            "Pork and bean casserole": "https://assets.nhs.uk/campaigns-cms-prod/original_images/Pork_and_bean_casserole.png",
            "Pork and garlic bread bake": "https://assets.nhs.uk/campaigns-cms-prod/original_images/Pork_and_garlic_bread_bake.png",
            "Pork with apples and celery": "https://assets.nhs.uk/campaigns-cms-prod/original_images/Pork_with_apples__celery.png",
            "Prawn jambalaya": "https://assets.nhs.uk/campaigns-cms-prod/original_images/Prawn_jambalaya_gegN48T.png",
            "Quick chicken couscous": "https://assets.nhs.uk/campaigns-cms-prod/original_images/Quick_chicken_couscous.png",
            "Quorn and vegetable stir-fry": "https://assets.nhs.uk/campaigns-cms-prod/original_images/card_Quorn_and_vegetable_stir-fry.png",
            "Roast chicken breast with peppers": "https://assets.nhs.uk/campaigns-cms-prod/original_images/Roast_chicken_breasts_with_peppers_KEhJvFK.png",
            "Roast chicken dinner": "https://assets.nhs.uk/campaigns-cms-prod/original_images/Roast-dinner.jpg",
            "Roasted veg and couscous": "https://assets.nhs.uk/campaigns-cms-prod/original_images/Roasted_veg_and_couscous_YZewYIv.png",
            "Salmon and broccoli pasta": "https://assets.nhs.uk/campaigns-cms-prod/original_images/Salmon__broccoli_pasta_upwJukm.png",
            "Salmon with spring onion mash": "https://assets.nhs.uk/campaigns-cms-prod/original_images/Salmon_with_spring_onion_mash.png",
            "Sausage and bean stew": "https://assets.nhs.uk/campaigns-cms-prod/original_images/Recipes-card-sausage-bean-stew.jpg",
            "Sausage, tomato and butter bean bake": "https://assets.nhs.uk/campaigns-cms-prod/original_images/Sausage_tomato_and_butter_bean_bake.jpg",
            "Shakshuka": "https://assets.nhs.uk/campaigns-cms-prod/original_images/Shakshuka.png",
            "Simple rajma curry": "https://assets.nhs.uk/campaigns-cms-prod/original_images/Simple_Rajma_Curry_Kidney_Curry.jpg",
            "Slow-cooked lamb and leek bake": "https://digitalcampaignsstorage.blob.core.windows.net/campaigns-cms-prod/original_images/card_2UErlcB.jpg",
            "Spaghetti bolognese": "https://assets.nhs.uk/campaigns-cms-prod/original_images/Spaghetti_bolognese.png",
            "Spider pies": "https://assets.nhs.uk/campaigns-cms-prod/original_images/Recipes_-_Card_-_Spider_pies.png",
            "Super savoury rice": "https://assets.nhs.uk/campaigns-cms-prod/original_images/Super_savoury_rice.png",
            "Super stew and dumplings": "https://assets.nhs.uk/campaigns-cms-prod/original_images/Super-stew-and-dumplings.jpg",
            "Sweet and sour chicken": "https://assets.nhs.uk/campaigns-cms-prod/original_images/Sweet_and_sour_chicken.png",
            "Sweet potato pasta": "https://assets.nhs.uk/campaigns-cms-prod/original_images/Sweet_potato_pasta.png",
            "Tandoori chicken quarters": "https://assets.nhs.uk/campaigns-cms-prod/original_images/Tandoori_Chicken_Qaurters.jpg",
            "Tasty tuna and sweetcorn pasta": "https://assets.nhs.uk/campaigns-cms-prod/original_images/Tasty_tuna_and_sweetcorn_pasta.png",
            "Tasty veggie chilli": "https://assets.nhs.uk/campaigns-cms-prod/original_images/Veggie_chilli.png",
            "Tuna and bean jackets": "https://assets.nhs.uk/campaigns-cms-prod/original_images/Tuna_and_bean_jackets.png",
            "Tuna, carrot and cheddar patties": "https://assets.nhs.uk/campaigns-cms-prod/original_images/Tuna_carrot_and_cheddar_patties.png",
            "Turkey burgers": "https://assets.nhs.uk/campaigns-cms-prod/original_images/Turkey-burgers.jpg",
            "Turkey koftas": "https://assets.nhs.uk/campaigns-cms-prod/original_images/Turkey-koftas.jpg",
            "Turkey stir-fry": "https://assets.nhs.uk/campaigns-cms-prod/original_images/Turkey-stir-fry.jpg",
            "Turkey tikka kebabs": "https://assets.nhs.uk/campaigns-cms-prod/original_images/Turkey_tikka_kebabs.png",
            "Veg and lentil cobbler": "https://assets.nhs.uk/campaigns-cms-prod/original_images/Lentils_and_veg_cobbler.png",
            "Veg mix with cheese sauce": "https://assets.nhs.uk/campaigns-cms-prod/original_images/Veg_mix_with_cheese_sauce.png",
            "Vegetable frittata": "https://assets.nhs.uk/campaigns-cms-prod/original_images/Veggie_frittata.jpg",
            "Vegetable jalfrezi": "https://assets.nhs.uk/campaigns-cms-prod/original_images/Vegetable_Jalfrezi.png",
            "Vegetarian Jamaican rundown": "https://assets.nhs.uk/campaigns-cms-prod/original_images/Vegetarian_Jamaican_Rundown.jpg",
            "Veggie spag bol recipe": "https://assets.nhs.uk/campaigns-cms-prod/original_images/Veggie_spag_bol_C1FcMuf.png",
            "Zombie peppers": "https://assets.nhs.uk/campaigns-cms-prod/original_images/Zombie-peppers.jpg"
        };
        const meals = Object.keys(mealData);

        const dayNames = ["Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday", "Sunday"];
        let currentPlan = [];
        let lockedDays = [false, false, false, false, false, false, false];

        const mealUrls = {
            "Asaro potato porridge": "https://www.nhs.uk/healthier-families/recipes/asaro-mpoto-mpoto-potato-casserole-pottage/",
            "Bajan cou cou with spicy fish": "https://www.nhs.uk/healthier-families/recipes/bajan-cou-cou-with-spicy-fish/",
            "Baked potatoes with mince": "https://www.nhs.uk/healthier-families/recipes/baked-potatoes-with-mince/",
            "Bang-tasty chicken drumsticks": "https://www.nhs.uk/healthier-families/recipes/roast-chicken-drumsticks/",
            "Bariis iskukaris": "https://www.nhs.uk/healthier-families/recipes/bariis-iskukaris/",
            "Bengali-style chicken curry": "https://www.nhs.uk/healthier-families/recipes/bengali-chicken-curry/",
            "Bharelu shaak": "https://www.nhs.uk/healthier-families/recipes/bharelu-shaak/",
            "Brilliant beef curry": "https://www.nhs.uk/healthier-families/recipes/brilliant-beef-curry/",
            "Caribbean tofu and sweet potato curry with rice and peas": "https://www.nhs.uk/healthier-families/recipes/caribbean-tofu-and-sweet-potato-curry-with-rice-and-peas/",
            "Cheats' pizza calzone": "https://www.nhs.uk/healthier-families/recipes/cheats-pizza-calzone/",
            "Cheese and tomato grilled fish": "https://www.nhs.uk/healthier-families/recipes/cheese-and-tomato-grilled-fish/",
            "Cheesy ham and leek bake": "https://www.nhs.uk/healthier-families/recipes/cheesy-ham-and-leek-bake/",
            "Cheesy veggie wedges": "https://www.nhs.uk/healthier-families/recipes/pasta-vegetable-cheese-wedges/",
            "Chicken and banana korma": "https://www.nhs.uk/healthier-families/recipes/chicken-and-banana-korma/",
            "Chicken and tomato jacket potato recipe": "https://www.nhs.uk/healthier-families/recipes/chicken-and-tomato-jacket-potato/",
            "Chicken and vegetable parcels": "https://www.nhs.uk/healthier-families/recipes/chicken-and-vegetable-parcels/",
            "Chicken jalfrezi": "https://www.nhs.uk/healthier-families/recipes/chicken-jalfrezi/",
            "Chicken pasta with peas": "https://www.nhs.uk/healthier-families/recipes/chicken-pasta-with-peas/",
            "Chilli beef and bean burgers": "https://www.nhs.uk/healthier-families/recipes/chilli-beef-and-bean-burgers/",
            "Chilli con carne": "https://www.nhs.uk/healthier-families/recipes/chilli-con-carne/",
            "Classic cottage pie": "https://www.nhs.uk/healthier-families/recipes/classic-cottage-pie/",
            "Corn frizzlers": "https://www.nhs.uk/healthier-families/recipes/sweetcorn-and-sweet-potato-fritters/",
            "Crunchy fish fingers with wedges": "https://www.nhs.uk/healthier-families/recipes/homemade-fish-fingers-with-sweet-potato-wedges/",
            "Deresh curry": "https://www.nhs.uk/healthier-families/recipes/deresh-aloo-curry/",
            "Ewa oloyin with plantain": "https://www.nhs.uk/healthier-families/recipes/ewa-oloyin-with-plantain/",
            "Eyeball meatballs": "https://www.nhs.uk/healthier-families/recipes/eyeball-halloween-meatballs/",
            "Fabulous fish pie": "https://www.nhs.uk/healthier-families/recipes/fabulous-fish-pie/",
            "Four seasons pizza": "https://www.nhs.uk/healthier-families/recipes/four-seasons-pizza/",
            "Good old fish and chips": "https://www.nhs.uk/healthier-families/recipes/homemade-fish-and-chips/",
            "Herby pasta with veg": "https://www.nhs.uk/healthier-families/recipes/herby-pasta-with-veg/",
            "Jerk-style chicken skewers": "https://www.nhs.uk/healthier-families/recipes/jerk-style-chicken-skewers/",
            "Jollof rice": "https://www.nhs.uk/healthier-families/recipes/jollof-rice/",
            "Kedgeree with a kick": "https://www.nhs.uk/healthier-families/recipes/kedgeree-with-a-kick/",
            "Lime fish skewers": "https://www.nhs.uk/healthier-families/recipes/garlic-ginger-lime-fish-skewers/",
            "Mac and veg slices": "https://www.nhs.uk/healthier-families/recipes/macaroni-and-vegetable-slices/",
            "Macaroni cheese with tomatoes": "https://www.nhs.uk/healthier-families/recipes/macaroni-cheese-with-tomatoes/",
            "Macher jhol": "https://www.nhs.uk/healthier-families/recipes/macher-jhol-bengali-fish-curry/",
            "Mean and green mac and cheese recipe": "https://www.nhs.uk/healthier-families/recipes/vegetable-mac-and-cheeese/",
            "Meat-free cottage pie": "https://www.nhs.uk/healthier-families/recipes/meat-free-cottage-pie/",
            "Meatballs and sauce": "https://www.nhs.uk/healthier-families/recipes/meatballs-and-sauce/",
            "Mediterranean potato bake": "https://www.nhs.uk/healthier-families/recipes/mediterranean-potato-bake/",
            "Mexican bean and tomato soup": "https://www.nhs.uk/healthier-families/recipes/mexican-bean-and-tomato-soup/",
            "Mushroom risotto": "https://www.nhs.uk/healthier-families/recipes/mushroom-risotto/",
            "Oat fufu with kale riro": "https://www.nhs.uk/healthier-families/recipes/oat-fufu-with-kale-riro/",
            "Old school sausage and mash": "https://www.nhs.uk/healthier-families/recipes/sausage-and-mash/",
            "Pakistani saag aloo": "https://www.nhs.uk/healthier-families/recipes/pakistani-saag-aloo/",
            "Panjabi dhal": "https://www.nhs.uk/healthier-families/recipes/panjabi-dhal/",
            "Panjabi keema": "https://www.nhs.uk/healthier-families/recipes/panjabi-keema/",
            "Pasta carbonara": "https://www.nhs.uk/healthier-families/recipes/pasta-carbonara/",
            "Pasta ratatouille bake": "https://www.nhs.uk/healthier-families/recipes/pasta-ratatouille-bake/",
            "Pea poppin' risotto": "https://www.nhs.uk/healthier-families/recipes/pea-and-spinach-risotto/",
            "Peppers with spicy turkey stuffing": "https://www.nhs.uk/healthier-families/recipes/spicy-turkey-stuffed-peppers/",
            "Perfect pasta and tomato sauce": "https://www.nhs.uk/healthier-families/recipes/perfect-pasta-and-tomato-sauce/",
            "Pesto and parmesan salmon": "https://www.nhs.uk/healthier-families/recipes/pesto-and-parmesan-salmon/",
            "Pesto tagliatelle, peppers and squash": "https://www.nhs.uk/healthier-families/recipes/pesto-tagliatelle-peppers-and-squash/",
            "Pigeon peas pilau with carrot pickle": "https://www.nhs.uk/healthier-families/recipes/pigeon-peas-pilau-with-carrot-pickle/",
            "Pork and bean casserole": "https://www.nhs.uk/healthier-families/recipes/pork-and-bean-casserole/",
            "Pork and garlic bread bake": "https://www.nhs.uk/healthier-families/recipes/pork-garlic-bread-bake/",
            "Pork with apples and celery": "https://www.nhs.uk/healthier-families/recipes/pork-with-apples-and-celery/",
            "Prawn jambalaya": "https://www.nhs.uk/healthier-families/recipes/prawn-jambalaya/",
            "Quick chicken couscous": "https://www.nhs.uk/healthier-families/recipes/quick-chicken-couscous/",
            "Quorn and vegetable stir-fry": "https://www.nhs.uk/healthier-families/recipes/quorn-and-vegetable-stir-fry/",
            "Roast chicken breast with peppers": "https://www.nhs.uk/healthier-families/recipes/roast-chicken-breast-with-peppers/",
            "Roast chicken dinner": "https://www.nhs.uk/healthier-families/recipes/roast-dinner/",
            "Roasted veg and couscous": "https://www.nhs.uk/healthier-families/recipes/roasted-veg-and-couscous/",
            "Salmon and broccoli pasta": "https://www.nhs.uk/healthier-families/recipes/salmon-and-broccoli-pasta/",
            "Salmon with spring onion mash": "https://www.nhs.uk/healthier-families/recipes/salmon-with-spring-onion-mash/",
            "Sausage and bean stew": "https://www.nhs.uk/healthier-families/recipes/sausage-and-bean-stew/",
            "Sausage, tomato and butter bean bake": "https://www.nhs.uk/healthier-families/recipes/sausage-tomato-butter-bean-bake/",
            "Shakshuka": "https://www.nhs.uk/healthier-families/recipes/shakshuka/",
            "Simple rajma curry": "https://www.nhs.uk/healthier-families/recipes/kidney-bean-rajma-curry/",
            "Slow-cooked lamb and leek bake": "https://www.nhs.uk/healthier-families/recipes/slow-cooked-lamb-and-leek-bake/",
            "Spaghetti bolognese": "https://www.nhs.uk/healthier-families/recipes/easy-spaghetti-bolognese/",
            "Spider pies": "https://www.nhs.uk/healthier-families/recipes/halloween-spider-chicken-pies/",
            "Super savoury rice": "https://www.nhs.uk/healthier-families/recipes/super-mixed-veg-rice/",
            "Super stew and dumplings": "https://www.nhs.uk/healthier-families/recipes/super-stew-and-dumplings/",
            "Sweet and sour chicken": "https://www.nhs.uk/healthier-families/recipes/sweet-and-sour-chicken/",
            "Sweet potato pasta": "https://www.nhs.uk/healthier-families/recipes/sweet-potato-pea-pasta/",
            "Tandoori chicken quarters": "https://www.nhs.uk/healthier-families/recipes/tandoori-chicken-quarters/",
            "Tasty tuna and sweetcorn pasta": "https://www.nhs.uk/healthier-families/recipes/tasty-tuna-and-sweetcorn-pasta/",
            "Tasty veggie chilli": "https://www.nhs.uk/healthier-families/recipes/tasty-vegetarian-chilli/",
            "Tuna and bean jackets": "https://www.nhs.uk/healthier-families/recipes/tuna-and-bean-jacket-potatoes/",
            "Tuna, carrot and cheddar patties": "https://www.nhs.uk/healthier-families/recipes/tuna-carrot-cheddar-patties/",
            "Turkey burgers": "https://www.nhs.uk/healthier-families/recipes/turkey-burgers/",
            "Turkey koftas": "https://www.nhs.uk/healthier-families/recipes/turkey-koftas/",
            "Turkey stir-fry": "https://www.nhs.uk/healthier-families/recipes/turkey-stir-fry/",
            "Turkey tikka kebabs": "https://www.nhs.uk/healthier-families/recipes/turkey-tikka-kebabs/",
            "Veg and lentil cobbler": "https://www.nhs.uk/healthier-families/recipes/vegetable-and-lentil-cobbler/",
            "Veg mix with cheese sauce": "https://www.nhs.uk/healthier-families/recipes/veg-mix-with-cheese-sauce/",
            "Vegetable frittata": "https://www.nhs.uk/healthier-families/recipes/courgette-and-tomato-vegetable-frittata/",
            "Vegetable jalfrezi": "https://www.nhs.uk/healthier-families/recipes/vegetable-jalfrezi/",
            "Vegetarian Jamaican rundown": "https://www.nhs.uk/healthier-families/recipes/vegetarian-jamaican-rundown/",
            "Veggie spag bol recipe": "https://www.nhs.uk/healthier-families/recipes/veggie-spag-bol-recipe/",
            "Zombie peppers": "https://www.nhs.uk/healthier-families/recipes/scary-stuffed-peppers/"
        };

        function getRecipeUrl(name) {
            return mealUrls[name] || "https://www.nhs.uk/healthier-families/recipes/dinner/";
        }

        function shuffleArray(arr) {
            const shuffled = [...arr];
            for (let i = shuffled.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [shuffled[i], shuffled[j]] = [shuffled[j], shuffled[i]];
            }
            return shuffled;
        }

        function pickWeeklyMeals() {
            const lockedMeals = new Set();
            lockedDays.forEach((locked, i) => {
                if (locked && currentPlan[i]) {
                    lockedMeals.add(currentPlan[i]);
                }
            });

            const available = meals.filter(m => !lockedMeals.has(m));
            const shuffled = shuffleArray(available);

            const newPlan = [];
            let pickIndex = 0;
            for (let i = 0; i < 7; i++) {
                if (lockedDays[i] && currentPlan[i]) {
                    newPlan.push(currentPlan[i]);
                } else {
                    newPlan.push(shuffled[pickIndex++]);
                }
            }
            return newPlan;
        }

        function renderCalendar() {
            const cal = document.getElementById('calendar');
            cal.innerHTML = '';

            dayNames.forEach((day, i) => {
                const meal = currentPlan[i];
                const isLocked = lockedDays[i];

                const card = document.createElement('div');
                card.className = 'day-card';
                card.id = `day-${i}`;

                card.innerHTML = `
                    <div class="day-header">
                        <span>${day}</span>
                        <span class="meal-count">Day ${i + 1}</span>
                    </div>
                    <img class="meal-img" src="${mealData[meal]}" alt="${meal}" loading="lazy">
                    <div class="day-body">
                        <div class="meal-name">${meal}</div>
                        <a class="meal-link" href="${getRecipeUrl(meal)}" target="_blank" rel="noopener">View recipe on NHS &rarr;</a>
                        <div class="day-actions">
                            <button class="btn-swap" onclick="swapDay(${i})" title="Get a different meal for this day">&#x1F504; Swap</button>
                            <button class="btn-lock ${isLocked ? 'locked' : ''}" onclick="toggleLock(${i})" title="${isLocked ? 'Unlock this day' : 'Lock this meal'}">
                                ${isLocked ? '&#x1F512; Locked' : '&#x1F513; Lock'}
                            </button>
                        </div>
                    </div>
                `;
                cal.appendChild(card);
            });
        }

        function shuffleAll() {
            currentPlan = pickWeeklyMeals();
            renderCalendar();

            document.querySelectorAll('.day-card').forEach((card, i) => {
                if (!lockedDays[i]) {
                    card.classList.add('shuffling');
                    setTimeout(() => card.classList.remove('shuffling'), 400);
                }
            });

            savePlan();
        }

        function swapDay(dayIndex) {
            if (lockedDays[dayIndex]) return;

            const usedMeals = new Set(currentPlan);
            const available = meals.filter(m => !usedMeals.has(m));

            if (available.length === 0) return;

            const randomMeal = available[Math.floor(Math.random() * available.length)];
            currentPlan[dayIndex] = randomMeal;
            renderCalendar();

            const card = document.getElementById(`day-${dayIndex}`);
            card.classList.add('shuffling');
            setTimeout(() => card.classList.remove('shuffling'), 400);

            savePlan();
        }

        function toggleLock(dayIndex) {
            lockedDays[dayIndex] = !lockedDays[dayIndex];
            renderCalendar();
            savePlan();
        }

        function savePlan() {
            localStorage.setItem('monkeyMealPlan', JSON.stringify({
                plan: currentPlan,
                locked: lockedDays
            }));
        }

        function loadPlan() {
            const saved = localStorage.getItem('monkeyMealPlan');
            if (saved) {
                const data = JSON.parse(saved);
                currentPlan = data.plan;
                lockedDays = data.locked || [false, false, false, false, false, false, false];

                const allValid = currentPlan.every(m => meals.includes(m));
                const allUnique = new Set(currentPlan).size === currentPlan.length;
                if (allValid && allUnique && currentPlan.length === 7) {
                    return true;
                }
            }
            return false;
        }

        // Initialise
        if (!loadPlan()) {
            currentPlan = pickWeeklyMeals();
        }
        renderCalendar();
    </script>
</body>
</html>
